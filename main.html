<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏à‡∏±‡∏Å‡∏£‡∏ß‡∏≤‡∏•‡∏ä‡∏µ‡∏ß‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤ (Biology Universe Map)</title>
    <!-- React and ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- D3.js -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <!-- Google Fonts: Sarabun for Thai -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', 'Outfit', sans-serif; background-color: #0f172a; overflow: hidden; }
        .glow-text { text-shadow: 0 0 10px rgba(255,255,255,0.5); }
        .tooltip {
            backdrop-filter: blur(8px);
            transition: all 0.2s ease;
            pointer-events: none;
        }
        /* Custom Button */
        .btn-glass {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .btn-glass:hover {
            background: rgba(51, 65, 85, 0.8);
            border-color: rgba(59, 130, 246, 0.5);
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.3);
            transform: translateY(-1px);
        }
        .btn-active {
            background: rgba(59, 130, 246, 0.2);
            border-color: #3b82f6;
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.4);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        // --- RAW DATA ---
        const rawData = [
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 2",
            "title": "‡πÄ‡∏Ñ‡∏°‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏™‡∏¥‡πà‡∏á‡∏°‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï",
            "group": "cell",
            "data": {
              "node": "‡πÄ‡∏Ñ‡∏°‡∏µ‡πÉ‡∏ô‡∏™‡∏¥‡πà‡∏á‡∏°‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï",
              "relation": "‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡∏µ‡∏¢‡πå‡πÅ‡∏•‡∏∞‡∏≠‡∏ô‡∏¥‡∏ô‡∏ó‡∏£‡∏µ‡∏¢‡πå",
              "targets": [
                {
                  "node": "‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô",
                  "relation": "‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ï‡πà‡∏≤‡∏á‡πÜ",
                  "targets": [
                    {
                      "node": "‡∏Ñ‡∏≤‡∏£‡πå‡πÇ‡∏ö‡πÑ‡∏Æ‡πÄ‡∏î‡∏£‡∏ï",
                      "relation": "‡πÄ‡∏õ‡πá‡∏ô",
                      "targets": [
                        {"node": "‡πÇ‡∏°‡πÇ‡∏ô‡πÅ‡∏ã‡πá‡∏Å‡∏Ñ‡∏≤‡πÑ‡∏£‡∏î‡πå"},
                        {"node": "‡πÑ‡∏î‡πÅ‡∏ã‡πá‡∏Å‡∏Ñ‡∏≤‡πÑ‡∏£‡∏î‡πå"},
                        {"node": "‡∏û‡∏≠‡∏•‡∏µ‡πÅ‡∏ã‡πá‡∏Å‡∏Ñ‡∏≤‡πÑ‡∏£‡∏î‡πå"}
                      ],
                      "function": "‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà",
                      "function_targets": [
                        {"node": "‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏∞‡∏™‡∏°‡∏Ç‡∏≠‡∏á‡∏û‡∏∑‡∏ä‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏ï‡∏ß‡πå"},
                        {"node": "‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏¢‡∏∑‡πà‡∏≠‡∏´‡∏∏‡πâ‡∏°‡πÄ‡∏ã‡∏•‡∏•‡πå"},
                        {"node": "‡πÉ‡∏´‡πâ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô"}
                      ]
                    },
                    {
                      "node": "‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô",
                      "relation": "‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢",
                      "targets": [{"node": "‡∏Å‡∏£‡∏î‡πÅ‡∏≠‡∏°‡∏¥‡πÇ‡∏ô"}],
                      "function": "‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà",
                      "function_targets": [
                        {"node": "‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏¢‡∏∑‡πà‡∏≠"},
                        {"node": "‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏≠‡∏≠‡∏£‡πå‡πÅ‡∏Å‡πÄ‡∏ô‡∏•‡∏•‡πå"},
                        {"node": "‡πÉ‡∏´‡πâ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô"},
                        {"node": "‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏≠‡∏ô‡πÑ‡∏ã‡∏°‡πå (‡πÄ‡∏£‡πà‡∏á‡∏õ‡∏è‡∏¥‡∏Å‡∏¥‡∏£‡∏¥‡∏¢‡∏≤‡πÄ‡∏Ñ‡∏°‡∏µ‡πÉ‡∏ô‡∏™‡∏¥‡πà‡∏á‡∏°‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï)"}
                      ]
                    },
                    {
                      "node": "‡∏•‡∏¥‡∏û‡∏¥‡∏î",
                      "relation": "‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà",
                      "targets": [
                        {"node": "‡∏Å‡∏•‡∏µ‡πÄ‡∏ã‡∏≠‡∏£‡∏≠‡∏•"},
                        {"node": "‡πÑ‡∏ï‡∏£‡∏Å‡∏•‡∏µ‡πÄ‡∏ã‡∏≠‡πÑ‡∏£‡∏î‡πå"},
                        {"node": "‡∏ü‡∏≠‡∏™‡πÇ‡∏ü‡∏•‡∏¥‡∏û‡∏¥‡∏î"},
                        {"node": "‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡∏≠‡∏¢‡∏î‡πå"}
                      ],
                      "function": "‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà",
                      "function_targets": [
                        {"node": "‡πÉ‡∏´‡πâ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô"},
                        {"node": "‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏¢‡∏∑‡πà‡∏≠‡∏´‡∏∏‡πâ‡∏°‡πÄ‡∏ã‡∏•‡∏•‡πå‡πÅ‡∏•‡∏∞‡∏ú‡∏ô‡∏±‡∏á‡πÄ‡∏ã‡∏•‡∏•‡πå"},
                        {"node": "‡πÄ‡∏õ‡πá‡∏ô‡∏â‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏•‡∏∞‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏π‡∏ç‡πÄ‡∏™‡∏µ‡∏¢‡∏ô‡πâ‡∏≥"}
                      ]
                    },
                    {
                      "node": "‡∏Å‡∏£‡∏î‡∏ô‡∏¥‡∏ß‡∏Ñ‡∏•‡∏µ‡∏≠‡∏¥‡∏Å",
                      "relation": "‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢",
                      "targets": [{"node": "‡∏ô‡∏¥‡∏ß‡∏Ñ‡∏•‡∏µ‡πÇ‡∏≠‡πÑ‡∏ó‡∏î‡πå (‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•, ‡πÑ‡∏ô‡πÇ‡∏ï‡∏£‡∏à‡∏µ‡∏ô‡∏±‡∏™‡πÄ‡∏ö‡∏™, ‡∏´‡∏°‡∏π‡πà‡∏ü‡∏≠‡∏™‡πÄ‡∏ü‡∏ï)"}],
                      "function": "‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà",
                      "function_targets": [{"node": "‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏≤‡∏£‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡∏Å‡∏£‡∏£‡∏°"}]
                    }
                  ]
                },
                {
                  "node": "‡∏ô‡πâ‡∏≥",
                  "function": "‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà",
                  "function_targets": [
                    {"node": "‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏ó‡∏≥‡∏•‡∏∞‡∏•‡∏≤‡∏¢"},
                    {"node": "‡∏•‡∏≥‡πÄ‡∏•‡∏µ‡∏¢‡∏á‡∏™‡∏≤‡∏£"},
                    {"node": "‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏î‡∏∏‡∏•‡∏¢‡∏†‡∏≤‡∏û‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥"},
                    {
                      "node": "‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏î‡∏∏‡∏•‡∏¢‡∏†‡∏≤‡∏û‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏£‡∏î-‡πÄ‡∏ö‡∏™",
                      "relation": "‡πÇ‡∏î‡∏¢‡∏°‡∏µ",
                      "targets": [
                        {
                          "node": "‡∏ö‡∏±‡∏ü‡πÄ‡∏ü‡∏≠‡∏£‡πå",
                          "relation": "‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢",
                          "targets": [{"node": "‡πÅ‡∏≠‡∏ô‡πÑ‡∏≠‡∏≠‡∏≠‡∏ô"}, {"node": "‡πÅ‡∏Ñ‡∏ô‡πÑ‡∏≠‡∏≠‡∏≠‡∏ô"}]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 3",
            "title": "‡πÄ‡∏ã‡∏•‡∏•‡πå‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏ã‡∏•‡∏•‡πå",
            "group": "cell",
            "data": {
              "node": "‡πÄ‡∏ã‡∏•‡∏•‡πå‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏ã‡∏•‡∏•‡πå",
              "targets": [
                {
                  "node": "‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏ã‡∏•‡∏•‡πå",
                  "relation": "‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏î‡πâ‡∏ß‡∏¢",
                  "targets": [
                    {"node": "‡πÄ‡∏¢‡∏∑‡πà‡∏≠‡∏´‡∏∏‡πâ‡∏°‡πÄ‡∏ã‡∏•‡∏•‡πå"},
                    {"node": "‡∏ô‡∏¥‡∏ß‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏™"},
                    {
                      "node": "‡πÑ‡∏ã‡πÇ‡∏ó‡∏û‡∏•‡∏≤‡∏ã‡∏∂‡∏°",
                      "relation": "‡∏°‡∏µ",
                      "targets": [
                        {"node": "‡∏≠‡∏≠‡∏£‡πå‡πÅ‡∏Å‡πÄ‡∏ô‡∏•‡∏•‡πå (‡πÄ‡∏ä‡πà‡∏ô ‡πÑ‡∏°‡πÇ‡∏ó‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏î‡∏£‡∏µ‡∏¢, ‡∏û‡∏•‡∏≤‡∏™‡∏ó‡∏¥‡∏î, ‡πÑ‡∏£‡πÇ‡∏ö‡πÇ‡∏ã‡∏°, ‡πÅ‡∏ß‡∏Ñ‡∏¥‡∏ß‡πÇ‡∏≠‡∏•)"}
                      ]
                    }
                  ]
                },
                {"node": "‡∏Å‡∏•‡πÑ‡∏Å‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏≠‡∏Å"},
                {
                  "node": "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏ã‡∏•‡∏•‡πå",
                  "targets": [
                    {
                      "node": "‡∏Å‡∏≤‡∏£‡∏•‡∏≥‡πÄ‡∏•‡∏µ‡∏¢‡∏á‡∏™‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏•‡∏•‡πå",
                      "relation": "‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô",
                      "targets": [
                        {"node": "‡∏≠‡∏≠‡∏™‡πÇ‡∏°‡∏ã‡∏¥‡∏™"},
                        {"node": "‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏£‡πà"},
                        {"node": "‡πÅ‡∏≠‡∏Ñ‡∏ó‡∏µ‡∏ü‡∏ó‡∏£‡∏≤‡∏ô‡∏™‡∏õ‡∏≠‡∏£‡πå‡∏ï"},
                        {"node": "‡πÄ‡∏≠‡∏ô‡πÇ‡∏î‡πÑ‡∏ã‡πÇ‡∏ó‡∏ã‡∏¥‡∏™"},
                        {"node": "‡πÄ‡∏≠‡∏Å‡πÇ‡∏ã‡πÑ‡∏ã‡πÇ‡∏ó‡∏ã‡∏¥‡∏™"}
                      ]
                    }
                  ]
                },
                {
                  "node": "‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏ã‡∏•‡∏•‡πå",
                  "relation": "‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô",
                  "targets": [{"node": "‡πÑ‡∏°‡πÇ‡∏ó‡∏ã‡∏¥‡∏™"}, {"node": "‡πÑ‡∏°‡πÇ‡∏≠‡∏ã‡∏¥‡∏™"}]
                }
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 4",
            "title": "‡πÇ‡∏Ñ‡∏£‡πÇ‡∏°‡πÇ‡∏ã‡∏°‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏£‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡∏Å‡∏£‡∏£‡∏°",
            "group": "genetics",
            "data": {
              "node": "‡∏™‡∏≤‡∏£‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡∏Å‡∏£‡∏£‡∏°‡∏Ç‡∏≠‡∏á‡∏™‡∏¥‡πà‡∏á‡∏°‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï",
              "relation": "‡πÄ‡∏õ‡πá‡∏ô",
              "targets": [
                {
                  "node": "DNA",
                  "relation": "‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢",
                  "targets": [
                    {
                      "node": "‡∏û‡∏≠‡∏•‡∏¥‡∏ô‡∏¥‡∏ß‡∏Ñ‡∏•‡∏µ‡πÇ‡∏≠‡πÑ‡∏ó‡∏î‡πå 2 ‡∏™‡∏≤‡∏¢",
                      "relation": "‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ",
                      "targets": [
                        {
                          "node": "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏î‡πâ",
                          "targets": [{"node": "‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏î‡∏µ‡πÄ‡∏≠‡πá‡∏ô‡πÄ‡∏≠ (DNA ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÇ‡∏°‡πÄ‡∏•‡∏Å‡∏∏‡∏•‡πÄ‡∏î‡∏¥‡∏°)"}]
                        },
                        {
                          "node": "‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ó‡∏≤‡∏á‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡∏Å‡∏£‡∏£‡∏°",
                          "relation": "‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏≤‡∏á",
                          "targets": [
                            {
                              "node": "‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô",
                              "relation": "‡πÇ‡∏î‡∏¢",
                              "targets": [
                                {"node": "‡∏¢‡∏µ‡∏ô (‡∏°‡∏µ‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™)"},
                                {"node": "‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏¢‡∏µ‡∏ô"}
                              ]
                            },
                            {"node": "rRNA"},
                            {"node": "mRNA (‡∏°‡∏µ‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏£‡∏´‡∏±‡∏™)"},
                            {"node": "tRNA"},
                            {"node": "‡∏û‡∏≠‡∏•‡∏¥‡πÄ‡∏û‡∏õ‡πÑ‡∏ó‡∏î‡πå"}
                          ]
                        },
                        {
                          "node": "‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏î‡πâ",
                          "targets": [
                            {
                              "node": "‡∏°‡∏¥‡∏ß‡πÄ‡∏ó‡∏ä‡∏±‡∏ô",
                              "relation": "‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô",
                              "targets": [{"node": "‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏¢‡∏µ‡∏ô"}, {"node": "‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÇ‡∏Ñ‡∏£‡πÇ‡∏°‡πÇ‡∏ã‡∏°"}]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 5",
            "title": "‡∏Å‡∏≤‡∏£‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏≠‡∏î‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ó‡∏≤‡∏á‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡∏Å‡∏£‡∏£‡∏°",
            "group": "genetics",
            "data": {
              "node": "‡∏Å‡∏≤‡∏£‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏≠‡∏î‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ó‡∏≤‡∏á‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡∏Å‡∏£‡∏£‡∏°",
              "relation": "‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö",
              "targets": [
                {
                  "node": "‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡∏Å‡∏£‡∏£‡∏°‡∏Ç‡∏≠‡∏á‡πÄ‡∏°‡∏ô‡πÄ‡∏î‡∏•",
                  "relation": "‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏õ‡πá‡∏ô",
                  "targets": [
                    {"node": "‡∏Å‡∏é‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å"},
                    {"node": "‡∏Å‡∏é‡∏Å‡∏≤‡∏£‡∏£‡∏ß‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏≠‡∏¥‡∏™‡∏£‡∏∞"}
                  ]
                },
                {
                  "node": "‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÄ‡∏°‡∏ô‡πÄ‡∏î‡∏•",
                  "relation": "‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà",
                  "targets": [
                    {"node": "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå"},
                    {"node": "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏ß‡∏°"},
                    {"node": "‡∏°‡∏±‡∏•‡∏ï‡∏¥‡πÄ‡∏û‡∏¥‡∏•‡πÅ‡∏≠‡∏•‡∏•‡∏µ‡∏•"},
                    {"node": "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏¢‡∏µ‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏π‡πà"},
                    {"node": "‡∏Å‡∏≤‡∏£‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏≠‡∏î‡∏¢‡∏µ‡∏ô‡πÉ‡∏ô‡πÑ‡∏ã‡πÇ‡∏ó‡∏û‡∏•‡∏≤‡∏ã‡∏∂‡∏°"}
                  ]
                },
                {
                  "node": "‡∏Å‡∏≤‡∏£‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏≠‡∏î‡∏¢‡∏µ‡∏ô‡∏ö‡∏ô‡πÇ‡∏Ñ‡∏£‡πÇ‡∏°‡πÇ‡∏ã‡∏°‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô",
                  "relation": "‡∏≠‡∏≤‡∏à‡πÄ‡∏Å‡∏¥‡∏î",
                  "targets": [{"node": "‡∏Ñ‡∏£‡∏≠‡∏™‡∏ã‡∏¥‡∏á‡πÇ‡∏≠‡πÄ‡∏ß‡∏≠‡∏£‡πå"}, {"node": "‡∏£‡∏µ‡∏Ñ‡∏≠‡∏°‡∏ö‡∏¥‡πÄ‡∏ô‡∏ä‡∏±‡∏ô"}]
                }
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 6",
            "title": "‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏ä‡∏µ‡∏ß‡∏†‡∏≤‡∏û‡∏î‡∏µ‡πÄ‡∏≠‡πá‡∏ô‡πÄ‡∏≠",
            "group": "genetics",
            "data": {
              "node": "‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏ä‡∏µ‡∏ß‡∏†‡∏≤‡∏û‡∏î‡∏µ‡πÄ‡∏≠‡πá‡∏ô‡πÄ‡∏≠",
              "relation": "‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö",
              "targets": [
                {
                  "node": "‡∏Å‡∏≤‡∏£‡πÇ‡∏Ñ‡∏•‡∏ô‡∏¢‡∏µ‡∏ô",
                  "relation": "‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì DNA",
                  "targets": [
                    {
                      "node": "‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°",
                      "relation": "‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ",
                      "targets": [{"node": "‡∏û‡∏•‡∏≤‡∏™‡∏°‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡πÅ‡∏ö‡∏Ñ‡∏ó‡∏µ‡πÄ‡∏£‡∏µ‡∏¢"}, {"node": "‡∏î‡∏µ‡πÄ‡∏≠‡πá‡∏ô‡πÄ‡∏≠‡∏£‡∏µ‡∏Ñ‡∏≠‡∏°‡∏ö‡∏¥‡πÅ‡∏ô‡∏ô‡∏ó‡πå"}]
                    },
                     {
                      "node": "‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ PCR",
                      "relation": "‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ",
                      "targets": [{"node": "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏°‡∏±‡∏•‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏•‡∏≠‡∏£‡πå"}]
                    }
                  ]
                },
                {
                  "node": "‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡πÉ‡∏ä‡πâ",
                  "relation": "‡πÉ‡∏ô‡∏î‡πâ‡∏≤‡∏ô",
                  "targets": [
                    {"node": "‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏£‡∏°"},
                    {"node": "‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡πÅ‡∏•‡∏∞‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°"},
                    {"node": "‡∏ô‡∏¥‡∏ï‡∏¥‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå"}
                  ]
                }
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 7",
            "title": "‡∏ß‡∏¥‡∏ß‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£",
            "group": "evolution",
            "data": {
              "node": "‡∏ß‡∏¥‡∏ß‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏™‡∏¥‡πà‡∏á‡∏°‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï",
              "targets": [
                {
                  "node": "‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏ß‡∏¥‡∏ß‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£",
                  "targets": [
                    {"node": "‡∏ã‡∏≤‡∏Å‡∏î‡∏∂‡∏Å‡∏î‡∏≥‡∏ö‡∏£‡∏£‡∏û‡πå"},
                    {"node": "‡∏Å‡∏≤‡∏¢‡∏ß‡∏¥‡∏†‡∏≤‡∏Ñ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö"},
                    {"node": "‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡πÄ‡∏≠‡πá‡∏°‡∏ö‡∏£‡∏¥‡πÇ‡∏≠"},
                    {"node": "‡∏ä‡∏µ‡∏ß‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡πÇ‡∏°‡πÄ‡∏•‡∏Å‡∏∏‡∏•"}
                  ]
                },
                {
                  "node": "‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏ß‡∏¥‡∏ß‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£",
                  "targets": [
                    {"node": "‡∏•‡∏≤‡∏°‡∏≤‡∏ã‡∏≤‡∏£‡πå‡∏Ñ (‡∏Å‡∏é‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ)"},
                    {"node": "‡∏î‡∏≤‡∏£‡πå‡∏ß‡∏¥‡∏ô (‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏î‡∏¢‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥)"}
                  ]
                },
                {
                  "node": "‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£",
                  "relation": "‡∏®‡∏∂‡∏Å‡∏©‡∏≤",
                  "targets": [
                    {"node": "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡πÅ‡∏≠‡∏•‡∏•‡∏µ‡∏•"},
                    {"node": "‡∏Æ‡∏≤‡∏£‡πå‡∏î‡∏µ-‡πÑ‡∏ß‡∏ô‡πå‡πÄ‡∏ö‡∏¥‡∏£‡πå‡∏Å"}
                  ]
                }
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 8",
            "title": "‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡∏ö‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏Ç‡∏≠‡∏á‡∏û‡∏∑‡∏ä‡∏î‡∏≠‡∏Å",
            "group": "plants",
            "data": {
              "node": "‡∏û‡∏∑‡∏ä‡∏î‡∏≠‡∏Å",
              "targets": [
                {
                  "node": "‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡∏≠‡∏Å",
                  "targets": [{"node": "‡∏Å‡∏•‡∏µ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á/‡∏î‡∏≠‡∏Å"}, {"node": "‡πÄ‡∏Å‡∏™‡∏£‡πÄ‡∏û‡∏®‡∏ú‡∏π‡πâ/‡πÄ‡∏°‡∏µ‡∏¢"}]
                },
                {
                  "node": "‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡πÅ‡∏ö‡∏ö‡∏™‡∏•‡∏±‡∏ö",
                  "targets": [{"node": "‡∏™‡∏õ‡∏≠‡πÇ‡∏£‡πÑ‡∏ü‡∏ï‡πå"}, {"node": "‡πÅ‡∏Å‡∏°‡∏µ‡πÇ‡∏ó‡πÑ‡∏ü‡∏ï‡πå"}]
                },
                {
                  "node": "‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏™‡∏ô‡∏ò‡∏¥‡∏Ñ‡∏π‡πà",
                  "targets": [
                    {"node": "‡πÑ‡∏ã‡πÇ‡∏Å‡∏ï (‡πÄ‡∏≠‡πá‡∏°‡∏ö‡∏£‡∏¥‡πÇ‡∏≠)"},
                    {"node": "‡πÄ‡∏≠‡∏ô‡πÇ‡∏î‡∏™‡πÄ‡∏õ‡∏¥‡∏£‡πå‡∏° (‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏∞‡∏™‡∏°)"}
                  ]
                }
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 9",
            "title": "‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡∏ä‡∏î‡∏≠‡∏Å",
            "group": "plants",
            "data": {
              "node": "‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡∏ä",
              "targets": [
                {
                  "node": "‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÄ‡∏¢‡∏∑‡πà‡∏≠‡∏û‡∏∑‡∏ä",
                  "targets": [
                    {"node": "‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÄ‡∏¢‡∏∑‡πà‡∏≠‡πÄ‡∏à‡∏£‡∏¥‡∏ç"},
                    {"node": "‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÄ‡∏¢‡∏∑‡πà‡∏≠‡∏ñ‡∏≤‡∏ß‡∏£ (‡∏ú‡∏¥‡∏ß, ‡∏û‡∏∑‡πâ‡∏ô, ‡∏•‡∏≥‡πÄ‡∏•‡∏µ‡∏¢‡∏á)"}
                  ]
                },
                {
                  "node": "‡∏≠‡∏ß‡∏±‡∏¢‡∏ß‡∏∞‡∏û‡∏∑‡∏ä",
                  "targets": [
                    {"node": "‡∏£‡∏≤‡∏Å"},
                    {"node": "‡∏•‡∏≥‡∏ï‡πâ‡∏ô"},
                    {"node": "‡πÉ‡∏ö (‡∏°‡∏µ‡πÇ‡∏ã‡∏ü‡∏¥‡∏•‡∏•‡πå)"}
                  ]
                }
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 10",
            "title": "‡∏Å‡∏≤‡∏£‡∏•‡∏≥‡πÄ‡∏•‡∏µ‡∏¢‡∏á‡∏Ç‡∏≠‡∏á‡∏û‡∏∑‡∏ä",
            "group": "plants",
            "data": {
              "node": "‡∏Å‡∏≤‡∏£‡∏•‡∏≥‡πÄ‡∏•‡∏µ‡∏¢‡∏á‡πÉ‡∏ô‡∏û‡∏∑‡∏ä",
              "targets": [
                {
                  "node": "‡∏Å‡∏≤‡∏£‡∏•‡∏≥‡πÄ‡∏•‡∏µ‡∏¢‡∏á‡∏ô‡πâ‡∏≥",
                  "relation": "‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏ã‡πÄ‡∏•‡πá‡∏°",
                  "targets": [{"node": "‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏£‡∏≤‡∏Å"}, {"node": "‡πÅ‡∏£‡∏á‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≤‡∏¢‡∏ô‡πâ‡∏≥"}]
                },
                {
                  "node": "‡∏Å‡∏≤‡∏£‡∏•‡∏≥‡πÄ‡∏•‡∏µ‡∏¢‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£",
                  "relation": "‡∏ú‡πà‡∏≤‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏≠‡πá‡∏°",
                  "targets": [{"node": "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô"}]
                },
                {"node": "‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏¥‡∏î‡∏õ‡∏≤‡∏Å‡πÉ‡∏ö"}
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 11",
            "title": "‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏î‡πâ‡∏ß‡∏¢‡πÅ‡∏™‡∏á",
            "group": "plants",
            "data": {
              "node": "Photosynthesis",
              "targets": [
                {
                  "node": "‡∏õ‡∏è‡∏¥‡∏Å‡∏¥‡∏£‡∏¥‡∏¢‡∏≤‡πÅ‡∏™‡∏á",
                  "targets": [{"node": "‡∏™‡∏£‡πâ‡∏≤‡∏á ATP, NADPH"}]
                },
                {
                  "node": "‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£‡∏Ñ‡∏±‡∏•‡∏ß‡∏¥‡∏ô",
                  "targets": [{"node": "‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏∂‡∏á‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô (‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•)"}]
                },
                {
                  "node": "‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏û‡∏∑‡∏ä",
                  "targets": [{"node": "C3"}, {"node": "C4"}, {"node": "CAM"}]
                }
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 12",
            "title": "‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏û‡∏∑‡∏ä",
            "group": "plants",
            "data": {
              "node": "‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏û‡∏∑‡∏ä",
              "targets": [
                {
                  "node": "‡∏Æ‡∏≠‡∏£‡πå‡πÇ‡∏°‡∏ô‡∏û‡∏∑‡∏ä",
                  "targets": [{"node": "‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡∏ô"}, {"node": "‡∏à‡∏¥‡∏ö‡πÄ‡∏ö‡∏≠‡πÄ‡∏£‡∏•‡∏•‡∏¥‡∏ô"}, {"node": "‡πÑ‡∏ã‡πÇ‡∏ó‡πÑ‡∏Ñ‡∏ô‡∏¥‡∏ô"}, {"node": "‡πÄ‡∏≠‡∏ó‡∏¥‡∏•‡∏µ‡∏ô"}, {"node": "‡∏Å‡∏£‡∏î‡πÅ‡∏≠‡∏ö‡πÑ‡∏ã‡∏ã‡∏¥‡∏Å"}]
                },
                {
                  "node": "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß",
                  "targets": [{"node": "Tropism (‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏™‡∏¥‡πà‡∏á‡πÄ‡∏£‡πâ‡∏≤)"}, {"node": "Nastic (‡πÑ‡∏°‡πà‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå)"}]
                }
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 13",
            "title": "‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡πà‡∏≠‡∏¢‡∏≠‡∏≤‡∏´‡∏≤‡∏£",
            "group": "animals",
            "data": {
              "node": "‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡πà‡∏≠‡∏¢‡∏≠‡∏≤‡∏´‡∏≤‡∏£",
              "targets": [
                {
                  "node": "‡∏™‡∏±‡∏ï‡∏ß‡πå",
                  "targets": [{"node": "‡∏¢‡πà‡∏≠‡∏¢‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏ã‡∏•‡∏•‡πå (‡∏ü‡∏≠‡∏á‡∏ô‡πâ‡∏≥)"}, {"node": "‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå (‡πÑ‡∏Æ‡∏î‡∏£‡∏≤)"}, {"node": "‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå"}]
                },
                {
                  "node": "‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå",
                  "targets": [
                    {"node": "‡∏õ‡∏≤‡∏Å/‡∏´‡∏•‡∏≠‡∏î‡∏≠‡∏≤‡∏´‡∏≤‡∏£"},
                    {"node": "‡∏Å‡∏£‡∏∞‡πÄ‡∏û‡∏≤‡∏∞‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (‡∏¢‡πà‡∏≠‡∏¢‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô)"},
                    {"node": "‡∏•‡∏≥‡πÑ‡∏™‡πâ‡πÄ‡∏•‡πá‡∏Å (‡∏¢‡πà‡∏≠‡∏¢/‡∏î‡∏π‡∏î‡∏ã‡∏∂‡∏°‡∏´‡∏•‡∏±‡∏Å)"},
                    {"node": "‡∏•‡∏≥‡πÑ‡∏™‡πâ‡πÉ‡∏´‡∏ç‡πà"}
                  ]
                }
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 14",
            "title": "‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏≤‡∏¢‡πÉ‡∏à",
            "group": "animals",
            "data": {
              "node": "‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏≤‡∏¢‡πÉ‡∏à",
              "targets": [
                {
                  "node": "‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏Å‡πä‡∏™",
                  "targets": [{"node": "‡πÄ‡∏´‡∏á‡∏∑‡∏≠‡∏Å (‡∏õ‡∏•‡∏≤)"}, {"node": "‡∏ó‡πà‡∏≠‡∏•‡∏° (‡πÅ‡∏°‡∏•‡∏á)"}, {"node": "‡∏õ‡∏≠‡∏î (‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ö‡∏Å)"}]
                },
                {
                  "node": "‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå",
                  "targets": [{"node": "‡∏à‡∏°‡∏π‡∏Å -> ‡∏´‡∏•‡∏≠‡∏î‡∏•‡∏° -> ‡∏õ‡∏≠‡∏î"}, {"node": "‡∏ñ‡∏∏‡∏á‡∏•‡∏° (Alveoli)"}, {"node": "‡∏Å‡∏∞‡∏ö‡∏±‡∏á‡∏•‡∏°"}]
                }
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 15",
            "title": "‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î",
            "group": "animals",
            "data": {
              "node": "Circulatory System",
              "targets": [
                {"node": "‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡∏¥‡∏î (‡πÅ‡∏°‡∏•‡∏á, ‡∏Å‡∏∏‡πâ‡∏á)"},
                {
                  "node": "‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏¥‡∏î (‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏°‡∏µ‡∏Å‡∏£‡∏∞‡∏î‡∏π‡∏Å‡∏™‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏á)",
                  "targets": [{"node": "‡∏´‡∏±‡∏ß‡πÉ‡∏à"}, {"node": "‡∏´‡∏•‡∏≠‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏î (Artery, Vein, Capillary)"}, {"node": "‡πÄ‡∏•‡∏∑‡∏≠‡∏î (RBC, WBC, Platelet)"}]
                },
                {"node": "‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡πâ‡∏≥‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á"}
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 16",
            "title": "‡∏£‡∏∞‡∏ö‡∏ö‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏±‡∏ô",
            "group": "animals",
            "data": {
              "node": "‡∏£‡∏∞‡∏ö‡∏ö‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏±‡∏ô",
              "targets": [
                {
                  "node": "‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏û‡∏≤‡∏∞",
                  "targets": [{"node": "‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á"}, {"node": "‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö"}, {"node": "‡∏ü‡∏≤‡πÇ‡∏Å‡πÑ‡∏ã‡∏ï‡πå"}]
                },
                {
                  "node": "‡πÅ‡∏ö‡∏ö‡∏à‡∏≥‡πÄ‡∏û‡∏≤‡∏∞",
                  "targets": [{"node": "B-cell (‡πÅ‡∏≠‡∏ô‡∏ï‡∏¥‡∏ö‡∏≠‡∏î‡∏µ)"}, {"node": "T-cell (‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡∏•‡∏•‡πå‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠)"}]
                }
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 17",
            "title": "‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏±‡∏ö‡∏ñ‡πà‡∏≤‡∏¢",
            "group": "animals",
            "data": {
              "node": "Excretory System",
              "targets": [
                {
                  "node": "‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå",
                  "targets": [{"node": "‡πÄ‡∏ü‡∏•‡∏°‡πÄ‡∏ã‡∏•‡∏•‡πå (‡∏û‡∏•‡∏≤‡∏ô‡∏≤‡πÄ‡∏£‡∏µ‡∏¢)"}, {"node": "‡πÄ‡∏ô‡∏ü‡∏£‡∏¥‡πÄ‡∏î‡∏µ‡∏¢‡∏° (‡πÑ‡∏™‡πâ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)"}, {"node": "‡∏ó‡πà‡∏≠‡∏°‡∏≤‡∏•‡∏û‡∏¥‡πÄ‡∏Å‡∏µ‡∏¢‡∏ô (‡πÅ‡∏°‡∏•‡∏á)"}]
                },
                {
                  "node": "‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå (‡πÑ‡∏ï)",
                  "targets": [{"node": "‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÑ‡∏ï (Nephron)"}, {"node": "‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á"}, {"node": "‡∏Å‡∏≤‡∏£‡∏î‡∏π‡∏î‡∏Å‡∏•‡∏±‡∏ö"}, {"node": "‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡πà‡∏á"}]
                }
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 18",
            "title": "‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ó",
            "group": "animals",
            "data": {
              "node": "Nervous System",
              "targets": [
                {
                  "node": "‡πÄ‡∏ã‡∏•‡∏•‡πå‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ó (Neuron)",
                  "targets": [{"node": "‡πÄ‡∏î‡∏ô‡πÑ‡∏î‡∏£‡∏ï‡πå"}, {"node": "‡πÅ‡∏≠‡∏Å‡∏ã‡∏≠‡∏ô"}, {"node": "‡πÑ‡∏ã‡πÅ‡∏ô‡∏õ‡∏™‡πå"}]
                },
                {
                  "node": "‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ó‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏•‡∏≤‡∏á (CNS)",
                  "targets": [{"node": "‡∏™‡∏°‡∏≠‡∏á"}, {"node": "‡πÑ‡∏Ç‡∏™‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏á"}]
                },
                {
                  "node": "‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ó‡∏£‡∏≠‡∏ö‡∏ô‡∏≠‡∏Å (PNS)",
                  "targets": [{"node": "‡πÄ‡∏™‡πâ‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ó‡∏™‡∏°‡∏≠‡∏á/‡πÑ‡∏Ç‡∏™‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏á"}, {"node": "‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ó‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (Sym/Para)"}]
                }
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 19",
            "title": "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà",
            "group": "animals",
            "data": {
              "node": "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà",
              "targets": [
                {"node": "‡∏™‡∏¥‡πà‡∏á‡∏°‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡πÄ‡∏ã‡∏•‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß (Cilia, Flagella, Pseudopodia)"},
                {"node": "‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏£‡∏∞‡∏î‡∏π‡∏Å‡∏™‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏á (‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠, ‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏ô‡πâ‡∏≥)"},
                {"node": "‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå (‡∏Å‡∏£‡∏∞‡∏î‡∏π‡∏Å‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠)"}
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 20",
            "title": "‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡πà‡∏≠‡∏°‡πÑ‡∏£‡πâ‡∏ó‡πà‡∏≠",
            "group": "animals",
            "data": {
              "node": "Endocrine System",
              "targets": [
                {"node": "‡∏ï‡πà‡∏≠‡∏°‡πÉ‡∏ï‡πâ‡∏™‡∏°‡∏≠‡∏á (Master Gland)"},
                {"node": "‡∏ï‡πà‡∏≠‡∏°‡πÑ‡∏ó‡∏£‡∏≠‡∏¢‡∏î‡πå (Metabolism)"},
                {"node": "‡∏ï‡πà‡∏≠‡∏°‡∏´‡∏°‡∏ß‡∏Å‡πÑ‡∏ï (Stress)"},
                {"node": "‡∏ï‡∏±‡∏ö‡∏≠‡πà‡∏≠‡∏ô (Insulin/Glucagon)"},
                {"node": "‡∏ï‡πà‡∏≠‡∏°‡πÄ‡∏û‡∏®"}
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 21",
            "title": "‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∑‡∏ö‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå",
            "group": "animals",
            "data": {
              "node": "Reproduction",
              "targets": [
                {"node": "‡πÑ‡∏°‡πà‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡πÄ‡∏û‡∏® (‡πÅ‡∏ï‡∏Å‡∏´‡∏ô‡πà‡∏≠, ‡∏á‡∏≠‡∏Å‡πÉ‡∏´‡∏°‡πà)"},
                {
                  "node": "‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡πÄ‡∏û‡∏® (‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå)",
                  "targets": [
                    {"node": "‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏™‡∏∏‡∏à‡∏¥ (Spermatogenesis)"},
                    {"node": "‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏Ç‡πà (Oogenesis)"},
                    {"node": "‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏™‡∏ô‡∏ò‡∏¥"},
                    {"node": "‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏Ç‡∏≠‡∏á‡πÄ‡∏≠‡πá‡∏°‡∏ö‡∏£‡∏¥‡πÇ‡∏≠"}
                  ]
                }
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 22",
            "title": "‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏±‡∏ï‡∏ß‡πå",
            "group": "animals",
            "data": {
              "node": "‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏±‡∏ï‡∏ß‡πå",
              "targets": [
                {"node": "‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏°‡∏≤‡πÅ‡∏ï‡πà‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î (Reflex, Taxis)"},
                {"node": "‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ (‡∏ù‡∏±‡∏á‡πÉ‡∏à, ‡∏•‡∏≠‡∏á‡∏ú‡∏¥‡∏î‡∏•‡∏≠‡∏á‡∏ñ‡∏π‡∏Å, ‡πÉ‡∏ä‡πâ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•)"}
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 23",
            "title": "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏•‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡∏ä‡∏µ‡∏ß‡∏†‡∏≤‡∏û",
            "group": "ecology",
            "data": {
              "node": "Biodiversity",
              "targets": [
                {
                  "node": "‡∏≠‡∏≤‡∏ì‡∏≤‡∏à‡∏±‡∏Å‡∏£‡∏™‡∏¥‡πà‡∏á‡∏°‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï",
                  "targets": [{"node": "Monera"}, {"node": "Protista"}, {"node": "Fungi"}, {"node": "Plantae"}, {"node": "Animalia"}]
                },
                {"node": "‡∏≠‡∏ô‡∏∏‡∏Å‡∏£‡∏°‡∏ß‡∏¥‡∏ò‡∏≤‡∏ô (Taxonomy)"}
              ]
            }
          },
          {
            "chapter": "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 24",
            "title": "‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏¥‡πÄ‡∏ß‡∏®",
            "group": "ecology",
            "data": {
              "node": "Ecosystem",
              "targets": [
                {"node": "‡πÑ‡∏ö‡πÇ‡∏≠‡∏° (Biomes)"},
                {"node": "‡∏Å‡∏≤‡∏£‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏≠‡∏î‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô (‡∏´‡πà‡∏ß‡∏á‡πÇ‡∏ã‡πà‡∏≠‡∏≤‡∏´‡∏≤‡∏£)"},
                {"node": "‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£‡∏™‡∏≤‡∏£ (‡∏ô‡πâ‡∏≥, ‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô, ‡πÑ‡∏ô‡πÇ‡∏ï‡∏£‡πÄ‡∏à‡∏ô)"},
                {"node": "‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£ (Population)"}
              ]
            }
          }
        ];

        // --- UTILS ---
        
        const processData = (data) => {
            const root = {
                id: "root",
                label: "‡∏ä‡∏µ‡∏ß‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤ (Biology)",
                group: "root",
                description: "‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏ä‡∏µ‡∏ß‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏™‡∏°‡∏±‡∏¢‡πÉ‡∏´‡∏°‡πà",
                children: []
            };

            const groupMap = {
                "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 2": "cell", "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 3": "cell",
                "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 4": "genetics", "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 5": "genetics", "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 6": "genetics",
                "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 7": "evolution",
                "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 8": "plants", "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 9": "plants", "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 10": "plants", "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 11": "plants", "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 12": "plants",
                "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 13": "animals", "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 14": "animals", "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 15": "animals", "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 16": "animals", "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 17": "animals", 
                "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 18": "animals", "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 19": "animals", "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 20": "animals", "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 21": "animals", "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 22": "animals",
                "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 23": "ecology", "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 24": "ecology"
            };

            data.forEach((chapter, index) => {
                const group = chapter.group || groupMap[chapter.chapter] || "tech";
                const chapterNode = {
                    id: `ch-${index}`,
                    label: chapter.title,
                    group: group,
                    description: chapter.chapter,
                    children: []
                };

                const processTargets = (targets, parentId) => {
                    if (!targets) return [];
                    return targets.map((t, i) => {
                        const id = `${parentId}-${i}`;
                        const desc = t.relation ? t.relation : (t.function ? `‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà: ${t.function}` : "");
                        const node = {
                            id: id,
                            label: t.node,
                            group: group,
                            description: desc,
                            children: []
                        };
                        
                        let childrenTargets = t.targets || [];
                        if (t.function_targets) {
                             const funcTargetsWrapped = t.function_targets.map(ft => ({...ft, relation: "‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà"}));
                             childrenTargets = [...childrenTargets, ...funcTargetsWrapped];
                        }

                        if (childrenTargets.length > 0) {
                            node.children = processTargets(childrenTargets, id);
                        }
                        return node;
                    });
                };

                if (chapter.data) {
                    if (chapter.data.targets) {
                        chapterNode.children = processTargets(chapter.data.targets, chapterNode.id);
                    } else if (Array.isArray(chapter.data)) {
                        chapterNode.children = processTargets(chapter.data, chapterNode.id);
                    }
                }
                
                root.children.push(chapterNode);
            });

            return root;
        };


        const flattenData = (rootData) => {
            const nodes = [];
            const links = [];
            
            // For tree mode, we need d3 hierarchy structure
            const hierarchy = d3.hierarchy(rootData);
            
            function recurse(node, parentId = null) {
                const newNode = { ...node, children: undefined, _children: node.children }; 
                nodes.push(newNode);
                
                if (parentId) {
                    links.push({ source: parentId, target: newNode.id, value: 1 });
                }
                
                if (node.children) {
                    node.children.forEach(child => recurse(child, node.id));
                }
            }
            
            recurse(rootData);
            return { nodes, links, hierarchy };
        };

        const colors = {
            root: "#ffffff",
            cell: "#3b82f6",     // Blue
            genetics: "#a855f7", // Purple
            evolution: "#22c55e",// Green
            plants: "#84cc16",   // Lime
            animals: "#f43f5e",  // Rose
            ecology: "#06b6d4",  // Cyan
            tech: "#64748b"      // Slate
        };

        // --- COMPONENTS ---

        const Legend = ({ items }) => (
            <div className="absolute top-4 right-4 bg-slate-900/80 backdrop-blur-md p-4 rounded-xl border border-slate-700 shadow-xl z-10 max-w-xs max-h-[80vh] overflow-y-auto hidden md:block">
                <h3 className="text-slate-300 font-semibold mb-3 text-sm uppercase tracking-wider font-sarabun">‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ (Clusters)</h3>
                <div className="space-y-2">
                    {items.map(item => (
                        <div key={item.key} className="flex items-center space-x-2">
                            <span className="w-3 h-3 rounded-full shadow-lg flex-shrink-0" style={{ backgroundColor: item.color, boxShadow: `0 0 8px ${item.color}` }}></span>
                            <span className="text-slate-400 text-xs font-medium font-sarabun">{item.label}</span>
                        </div>
                    ))}
                </div>
            </div>
        );

        const ConstellationGraph = () => {
            const svgRef = useRef(null);
            const containerRef = useRef(null);
            const [hoveredNode, setHoveredNode] = useState(null);
            const [dimensions, setDimensions] = useState({ width: 800, height: 600 });
            const [mode, setMode] = useState('galaxy'); // 'galaxy' | 'structured'
            
            const graphData = useMemo(() => {
                const processed = processData(rawData);
                // Pre-sort children by group for structured mode
                processed.children.sort((a, b) => {
                    const groups = ['cell', 'genetics', 'evolution', 'plants', 'animals', 'ecology'];
                    return groups.indexOf(a.group) - groups.indexOf(b.group);
                });
                return flattenData(processed);
            }, []);

            useEffect(() => {
                const updateDimensions = () => {
                    if (containerRef.current) {
                        setDimensions({
                            width: containerRef.current.clientWidth,
                            height: containerRef.current.clientHeight
                        });
                    }
                };
                window.addEventListener('resize', updateDimensions);
                updateDimensions();
                return () => window.removeEventListener('resize', updateDimensions);
            }, []);

            useEffect(() => {
                if (!svgRef.current || !graphData.nodes.length) return;

                const { width, height } = dimensions;
                const svg = d3.select(svgRef.current);
                svg.selectAll("*").remove(); 

                // --- DEFS for Glow ---
                const defs = svg.append("defs");
                const filter = defs.append("filter").attr("id", "glow");
                filter.append("feGaussianBlur").attr("stdDeviation", "2.5").attr("result", "coloredBlur");
                const feMerge = filter.append("feMerge");
                feMerge.append("feMergeNode").attr("in", "coloredBlur");
                feMerge.append("feMergeNode").attr("in", "SourceGraphic");

                // Gradient for Links
                const gradient = defs.append("linearGradient")
                    .attr("id", "link-gradient")
                    .attr("gradientUnits", "userSpaceOnUse");
                gradient.append("stop").attr("offset", "0%").attr("stop-color", "#334155").attr("stop-opacity", 0.1);
                gradient.append("stop").attr("offset", "50%").attr("stop-color", "#94a3b8").attr("stop-opacity", 0.8);
                gradient.append("stop").attr("offset", "100%").attr("stop-color", "#334155").attr("stop-opacity", 0.1);

                const g = svg.append("g");
                
                const zoom = d3.zoom()
                    .scaleExtent([0.05, 4])
                    .on("zoom", (event) => {
                        g.attr("transform", event.transform);
                    });

                svg.call(zoom);

                // Initial Transform based on mode
                if (mode === 'galaxy') {
                     svg.call(zoom.transform, d3.zoomIdentity.translate(width/2, height/2).scale(0.12).translate(-width/2, -height/2));
                } else {
                     svg.call(zoom.transform, d3.zoomIdentity.translate(100, height/2).scale(0.8));
                }


                // --- DATA PREP & LINKS ---
                const link = g.append("g")
                    .attr("fill", "none")
                    .attr("stroke-width", 4)  // thicker links
                    .selectAll("path")
                    .data(graphData.links)
                    .join("path")
                    .attr("class", "link")
                    .attr("stroke", "url(#link-gradient)")
                    .style("filter", "url(#glow)"); // Glow effect

                const node = g.append("g")
                    .selectAll("g") // Group for circle + text to move together
                    .data(graphData.nodes)
                    .join("g")
                    .style("cursor", "pointer");

                const circle = node.append("circle")
                    .attr("r", d => {
                        if (d.id === 'root') return 30;
                        if (d.id.startsWith('ch-')) return 15; 
                        return Math.max(3, 8 - d.id.split('-').length);
                    })
                    .attr("fill", d => colors[d.group])
                    .attr("stroke", "#0f172a")
                    .attr("stroke-width", 1);

                const text = node.append("text")
                    .text(d => d.label)
                    .attr("x", d => d.id === 'root' ? 35 : 18)
                    .attr("y", 5)
                    .attr("fill", "#94a3b8")
                    .attr("font-family", "Sarabun, sans-serif")
                    .attr("font-size", d => {
                         if (d.id === 'root') return "40px";
                         if (d.id.startsWith('ch-')) return "24px";
                         return "10px";
                    })
                    .attr("font-weight", d => d.id === 'root' || d.id.startsWith('ch-') ? "bold" : "normal")
                    .style("pointer-events", "none")
                    .style("text-shadow", "0 2px 4px #000");


                // --- SIMULATION (GALAXY MODE) ---
                let simulation;

                if (mode === 'galaxy') {
                    simulation = d3.forceSimulation(graphData.nodes)
                        .force("link", d3.forceLink(graphData.links)
                            .id(d => d.id)
                            .distance(d => d.target.children ? 320 : 190) // more spacing between levels
                        ) 
                        .force("charge", d3.forceManyBody().strength(d => d.id === 'root' ? -8000 : -2500)) // stronger repulsion
                        .force("center", d3.forceCenter(width / 2, height / 2))
                        .force("collide", d3.forceCollide().radius(d => d.children ? 120 : 55).iterations(2)) // bigger collide radius
                        .velocityDecay(0.55);

                    simulation.on("tick", () => {
                        link.attr("d", d => `M${d.source.x},${d.source.y} L${d.target.x},${d.target.y}`);
                        node.attr("transform", d => `translate(${d.x},${d.y})`);
                    });

                    // Drag behavior only for galaxy mode
                    node.call(d3.drag()
                        .on("start", (event, d) => {
                            if (!event.active) simulation.alphaTarget(0.3).restart();
                            d.fx = d.x;
                            d.fy = d.y;
                        })
                        .on("drag", (event, d) => {
                            d.fx = event.x;
                            d.fy = event.y;
                        })
                        .on("end", (event, d) => {
                            if (!event.active) simulation.alphaTarget(0);
                            d.fx = null;
                            d.fy = null;
                        }));

                } else {
                    // --- TREE MODE (STRUCTURED) ---
                    // 1. Re-construct hierarchy for tree layout
                    const rootHierarchy = d3.hierarchy(processData(rawData));
                    
                    // Sort children: Group > Chapter > Subtopic
                    const groupOrder = ['cell', 'genetics', 'evolution', 'plants', 'animals', 'ecology'];
                    rootHierarchy.sort((a, b) => {
                         // Sort by group first
                         const gA = groupOrder.indexOf(a.data.group);
                         const gB = groupOrder.indexOf(b.data.group);
                         if (gA !== gB) return gA - gB;
                         return 0;
                    });

                    // 2. Compute Tree Layout
                    // Increase vertical spacing
                    const treeHeight = Math.max(height, rootHierarchy.descendants().length * 35);
                    const treeLayout = d3.tree().size([treeHeight, width * 1.8]);
                    
                    treeLayout(rootHierarchy);

                    // 3. Map tree coordinates back to our graphData.nodes
                    const nodeMap = new Map(rootHierarchy.descendants().map(d => [d.data.id, d]));

                    // Update positions
                    graphData.nodes.forEach(n => {
                        const treeNode = nodeMap.get(n.id);
                        if (treeNode) {
                            n.x = treeNode.y; // Swap x/y for horizontal tree
                            n.y = treeNode.x;
                        }
                    });

                    // Update Visuals (Static)
                    node.transition().duration(1000)
                        .attr("transform", d => `translate(${d.x},${d.y})`);

                    link.transition().duration(1000)
                        .attr("d", d3.linkHorizontal()
                            .x(d => d.x)
                            .y(d => d.y)
                        );
                }

                // Interactions
                node.on("mouseover", (event, d) => {
                    d3.select(event.currentTarget).select("circle")
                        .transition().duration(200)
                        .attr("r", r => parseFloat(d3.select(event.currentTarget).select("circle").attr("r")) * 1.5)
                        .attr("filter", "drop-shadow(0 0 10px rgba(255,255,255,0.6))");
                    
                    setHoveredNode({
                        ...d,
                        x: event.pageX,
                        y: event.pageY
                    });
                })
                .on("mouseout", (event, d) => {
                     d3.select(event.currentTarget).select("circle")
                        .transition().duration(200)
                        .attr("r", d => {
                             if (d.id === 'root') return 30;
                             if (d.id.startsWith('ch-')) return 15;
                             return Math.max(3, 8 - d.id.split('-').length);
                        })
                        .attr("filter", null);
                    setHoveredNode(null);
                });

                return () => {
                    if (simulation) simulation.stop();
                };

            }, [dimensions, graphData, mode]); // Re-run when mode changes

            return (
                <div className="relative w-full h-screen bg-slate-900 overflow-hidden font-sarabun" ref={containerRef}>
                    
                    {/* Background Stars Effect */}
                    <div className="absolute inset-0 z-0 opacity-40 pointer-events-none" 
                        style={{backgroundImage: 'radial-gradient(circle at center, #1e293b 0%, #0f172a 100%)'}}>
                    </div>
                    
                    {/* Header */}
                    <div className="absolute top-6 left-6 z-10 pointer-events-none select-none">
                        <h1 className="text-4xl font-bold text-white tracking-tight glow-text font-sarabun">‡∏à‡∏±‡∏Å‡∏£‡∏ß‡∏≤‡∏• <span className="text-blue-400">‡∏ä‡∏µ‡∏ß‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</span></h1>
                        <p className="text-slate-400 text-sm mt-1 font-sarabun">‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏â‡∏ö‡∏±‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå (24 ‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô)</p>
                    </div>

                    {/* Mode Toggle */}
                    <div className="absolute top-6 left-1/2 transform -translate-x-1/2 z-20 flex space-x-4">
                        <button 
                            onClick={() => setMode('galaxy')}
                            className={`px-6 py-2 rounded-full text-sm font-semibold text-white transition-all btn-glass ${mode === 'galaxy' ? 'btn-active' : ''}`}
                        >
                            üåå Galaxy View
                        </button>
                        <button 
                            onClick={() => setMode('structured')}
                            className={`px-6 py-2 rounded-full text-sm font-semibold text-white transition-all btn-glass ${mode === 'structured' ? 'btn-active' : ''}`}
                        >
                            üìë Order Alignment
                        </button>
                    </div>

                    {/* D3 Graph */}
                    <svg ref={svgRef} width={dimensions.width} height={dimensions.height} className={`z-0 ${mode === 'galaxy' ? 'cursor-move' : 'cursor-default'}`}></svg>

                    {/* Tooltip */}
                    {hoveredNode && (
                        <div 
                            className="absolute z-20 tooltip bg-slate-800/95 border border-slate-600 p-4 rounded-lg shadow-2xl max-w-xs pointer-events-none"
                            style={{ 
                                left: Math.min(hoveredNode.x + 20, dimensions.width - 320),
                                top: Math.min(hoveredNode.y - 20, dimensions.height - 200),
                            }}
                        >
                            <div className="flex items-center gap-2 mb-2 pb-2 border-b border-slate-700">
                                <span className="w-3 h-3 rounded-full flex-shrink-0" style={{backgroundColor: colors[hoveredNode.group]}}></span>
                                <h4 className="text-white font-bold text-lg font-sarabun leading-tight">{hoveredNode.label}</h4>
                            </div>
                            {hoveredNode.description && (
                                <p className="text-slate-300 text-sm leading-relaxed font-sarabun mb-2">
                                    <span className="text-slate-500 text-xs uppercase block mb-1">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î:</span>
                                    {hoveredNode.description}
                                </p>
                            )}
                             <div className="flex justify-between items-center mt-2">
                                <span className="text-xs text-slate-500 font-mono uppercase tracking-widest font-sarabun">{hoveredNode.group}</span>
                                <span className="text-[10px] text-slate-600 font-mono">{hoveredNode.id}</span>
                            </div>
                        </div>
                    )}

                    {/* Legend */}
                    <Legend items={[
                        { key: 'cell', label: '‡πÄ‡∏Ñ‡∏°‡∏µ & ‡πÄ‡∏ã‡∏•‡∏•‡πå (‡∏ö‡∏ó 2-3)', color: colors.cell },
                        { key: 'genetics', label: '‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå (‡∏ö‡∏ó 4-6)', color: colors.genetics },
                        { key: 'evolution', label: '‡∏ß‡∏¥‡∏ß‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£ (‡∏ö‡∏ó 7)', color: colors.evolution },
                        { key: 'plants', label: '‡∏û‡∏∑‡∏ä (‡∏ö‡∏ó 8-12)', color: colors.plants },
                        { key: 'animals', label: '‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡∏±‡∏ï‡∏ß‡πå (‡∏ö‡∏ó 13-22)', color: colors.animals },
                        { key: 'ecology', label: '‡∏ô‡∏¥‡πÄ‡∏ß‡∏®‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤ (‡∏ö‡∏ó 23-24)', color: colors.ecology },
                    ]} />
                </div>
            );
        };

        const App = () => {
            return <ConstellationGraph />;
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
